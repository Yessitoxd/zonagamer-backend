<style>
    body {
        background: #4d248e;
    }
</style>
<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Panel de Administrador</title>
    <link rel="icon" type="image/jpeg" href="Logo.jpg">
    <link rel="stylesheet" href="estilos_responsive.css">
    <style>
        /* Diseño de dos cuadros alineados horizontalmente, centrados verticalmente */
        .admin-panel-figma-layout {
            display: flex;
            flex-direction: row;
            align-items: stretch; /* Hace que ambos hijos tengan la misma altura */
            justify-content: center;
            gap: 32px;
            width: 90vw;
            height: 80vh;
            min-height: 600px;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
        }
        .admin-figma-sidebar {
            background: linear-gradient(135deg, #2a114d 0%, #3b1d69 100%);
            border: 2.5px solid #3ef2e6;
            border-top-left-radius: 40px;
            border-bottom-left-radius: 40px;
            border-top-right-radius: 0;
            border-bottom-right-radius: 0;
            width: 220px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.25);
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            gap: 0;
            overflow: hidden;
        }
        .admin-figma-mainbox {
    /* ====== FIN COPIA ESTILOS CUADROS ADMIN ====== */
            background: linear-gradient(135deg, #2a114d 0%, #3b1d69 100%);
            border: 2.5px solid #3ef2e6;
            border-radius: 32px;
            width: 800px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.45);
            display: flex;
            flex-direction: column;
            padding: 32px;
            color: #fff;
        }
        @media (max-width: 700px) {
            .admin-panel-figma-layout {
                flex-direction: column;
                align-items: center;
                gap: 18px;
                margin-top: 32px;
            }
            .admin-figma-sidebar, .admin-figma-mainbox {
                width: 95vw;
                min-width: unset;
                max-width: 98vw;
                border-radius: 32px !important;
                height: 220px;
            }
        }
        /* Contenedor de los dos cuadros */
        .admin-main-layout {
            display: flex;
            flex-direction: row;
            justify-content: center;
            align-items: flex-start;
            gap: 32px;
            margin-top: 48px;
            width: 100%;
        }
        .admin-side-box {
            background: linear-gradient(135deg, #2a114d 0%, #3b1d69 100%);
            border: 2.5px solid #3ef2e6;
            border-radius: 18px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.45);
            width: 120px;
            min-width: 90px;
            height: 400px;
            max-height: 80vh;
            overflow-y: auto;
            color: #fff;
            padding: 18px 10px;
        }
        .admin-content-box {
            background: linear-gradient(135deg, #2a114d 0%, #3b1d69 100%);
            border: 2.5px solid #3ef2e6;
            border-radius: 18px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.45);
            width: 540px;
            min-width: 320px;
            height: 400px;
            max-height: 80vh;
            overflow-y: auto;
            color: #fff;
            padding: 32px 28px;
        }
        @media (max-width: 900px) {
            .admin-main-layout {
                flex-direction: column;
                align-items: center;
                gap: 18px;
            }
            .admin-content-box, .admin-side-box {
                width: 95vw;
                min-width: unset;
                max-width: 98vw;
            }
        }
        .sidebar-btn {
            width: 85%;
            min-width: 120px;
            max-width: 180px;
            margin: 0 auto;
            margin-bottom: 0;
            padding: 10px 0;
            background: transparent;
            color: #81fde9;
            border: none;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 600;
            cursor: pointer;
            transition: color 0.2s, box-shadow 0.2s, background 0.2s;
            box-shadow: none;
            outline: none;
            text-align: center;
            white-space: normal;
            word-break: break-word;
            overflow: visible;
            display: block;
        }
        .sidebar-btn:hover, .sidebar-btn.active {
            background: #1a0733;
            color: #fff;
            box-shadow: 0 0 8px 2px #81fde9, 0 0 16px 2px #3ef2e6;
            border-radius: 10px;
        }
        .logout-btn {
            margin-top: auto;
            margin-bottom: 18px;
            width: 85%;
            min-width: 120px;
            max-width: 180px;
            padding: 10px 0;
            background: transparent;
            color: #81fde9;
            border: 2px solid #81fde9;
            border-radius: 10px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 0 8px 2px #81fde9, 0 0 16px 2px #3ef2e6;
            transition: box-shadow 0.2s, color 0.2s, background 0.2s;
            outline: none;
            text-align: center;
            white-space: normal;
            word-break: break-word;
            display: block;
        }
        .logout-btn:hover, .logout-btn.active {
            background: #1a0733;
            color: #fff;
            box-shadow: 0 0 8px 2px #81fde9, 0 0 16px 2px #3ef2e6;
            border-radius: 10px;
        }
        .admin-login-container .neon-anim-border .neon-stroke-2 {
            fill: none;
            stroke: #81fde9;
            stroke-width: 4;
            stroke-dasharray: 120, 1080;
            stroke-dashoffset: 600;
            filter: drop-shadow(0 0 8px #81fde9) drop-shadow(0 0 16px #81fde9);
            animation: neon-stroke-2 2.5s linear infinite;
        }
        @keyframes neon-stroke-1 {
            0% { stroke-dashoffset: 0; }
            100% { stroke-dashoffset: -1200; }
        }
        @keyframes neon-stroke-2 {
            0% { stroke-dashoffset: 600; }
            100% { stroke-dashoffset: -600; }
        }
        .admin-login-container {
            background: linear-gradient(135deg, #2a114d 0%, #3b1d69 100%);
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            padding: 32px 32px 24px 32px;
            border-radius: 18px;
            box-shadow: 0 8px 32px rgba(0,0,0,0.45);
            width: 350px;
            min-width: 280px;
            text-align: center;
            color: #fff;
            border: 2.5px solid #3ef2e6;
            z-index: 10;
            margin: 0;
        }
        @media (max-width: 600px) {
            .admin-login-container {
                width: 95vw;
                min-width: unset;
                padding: 18px 4vw 18px 4vw;
            }
        }
        .input-group input {
            width: 100%;
            padding: 12px;
            border: 1px solid #cccccc;
            border-radius: 8px;
            box-sizing: border-box;
            font-size: 16px;
        }
        .input-group input:focus {
            outline: none;
            border-color: var(--main-color);
            box-shadow: 0 0 0 3px rgba(77, 36, 142, 0.2);
        }
        /* Botón de Iniciar Sesión (login) con efecto neón */
        #adminLoginForm button[type="submit"] {
            width: 100%;
            padding: 12px;
            background: transparent;
            color: #81fde9;
            border: 2px solid #81fde9;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            margin-top: 10px;
            box-shadow: 0 0 8px 2px #81fde9, 0 0 16px 2px #3ef2e6;
            transition: box-shadow 0.2s, color 0.2s, background 0.2s;
            outline: none;
            overflow: hidden;
            display: flex;
            flex-direction: column;
            justify-content: flex-start;
            align-items: center;
        }
        #adminLoginForm button[type="submit"]:hover, #adminLoginForm button[type="submit"]:focus {
            background: #1a0733;
            color: #fff;
            box-shadow: 0 0 16px 4px #81fde9, 0 0 32px 4px #3ef2e6;
        }

        .error-message {
            color: #ff4d4d;
            font-weight: bold;
            margin-top: 10px;
            text-align: center;
        }
        .admin-panel-sesiones {
            display: none;
            margin-top: 40px;
            width: 100%;
            max-width: 900px;
            background: rgba(0,0,0,0.3);
            border-radius: 12px;
            padding: 32px;
            box-shadow: 0 4px 12px rgba(0,0,0,0.1);
        }
        .admin-panel-sesiones h2 {
            color: var(--accent-color);
            margin-bottom: 24px;
        }
        /* Neon select y input para añadir consola */
        .neon-select, .neon-input {
            width: 100%;
            padding: 10px;
            border-radius: 8px;
            font-size: 16px;
            background: #2a114d;
            color: #81fde9;
            border: 2px solid #3ef2e6;
            box-shadow: 0 0 8px #3ef2e6, 0 0 16px #81fde9;
            outline: none;
            transition: box-shadow 0.2s, border-color 0.2s;
        }
        .neon-select:focus, .neon-input:focus {
            border-color: #81fde9;
            box-shadow: 0 0 16px 4px #81fde9, 0 0 32px 4px #3ef2e6;
        }
        .neon-select option {
            background: #1a0733;
            color: #81fde9;
        }
        /* Botón azul neón para añadir consola */
        .neon-btn {
            margin-top: 10px;
            width: 100%;
            padding: 12px;
            background: linear-gradient(135deg, #1a0733 0%, #3b1d69 100%);
            color: #81fde9;
            border: 2px solid #3ef2e6;
            border-radius: 8px;
            font-size: 18px;
            font-weight: 700;
            cursor: pointer;
            box-shadow: 0 0 8px 2px #3ef2e6, 0 0 16px 2px #81fde9;
            transition: box-shadow 0.2s, color 0.2s, background 0.2s;
            outline: none;
        }
        .neon-btn:hover, .neon-btn:focus {
            background: #2a114d;
            color: #fff;
            box-shadow: 0 0 16px 4px #81fde9, 0 0 32px 4px #3ef2e6;
        }
    </style>
</head>
<body>
    <!-- Logo eliminado -->
    <div class="admin-login-container" id="adminLoginContainer">
        <h2>Ingreso Administrador</h2>
        <form id="adminLoginForm">
            <div class="input-group">
                <label for="adminUsername">Usuario</label>
                <input type="text" id="adminUsername" name="adminUsername" placeholder="Usuario admin" required>
            </div>
            <div class="input-group">
                <label for="adminPassword">Contraseña</label>
                <input type="password" id="adminPassword" name="adminPassword" placeholder="Contraseña" required>
            </div>
            <p id="adminErrorMessage" class="error-message"></p>
            <button type="submit">Iniciar Sesión</button>
        </form>
    </div>
    <div id="adminPanelSesiones" style="display:none;">
        <div class="admin-panel-figma-layout">
            <div class="admin-figma-sidebar">
                <div style="display: flex; flex-direction: column; height: 100%; justify-content: space-between;">
                    <div style="display: flex; flex-direction: column; flex: 1 1 auto; justify-content: flex-start; gap: 32px; padding-top: 24px; padding-bottom: 24px;">
                        <button class="sidebar-btn" onclick="showSession('reporte')" id="btn-reporte">Reporte<br>general</button>
                        <button class="sidebar-btn" onclick="showSession('descargar')" id="btn-descargar">Descargar<br>reporte</button>
                        <button class="sidebar-btn" onclick="showSession('consolas')" id="btn-consolas">Añadir<br>consolas</button>
                        <button class="sidebar-btn" onclick="showSession('precios')" id="btn-precios">Añadir<br>precios</button>
                    </div>
                    <button class="sidebar-btn logout-btn" onclick="window.location.href='Index.html'">Cerrar sesión</button>
                </div>
            </div>
            <div class="admin-figma-mainbox">
                <div id="mainbox-session-reporte" class="mainbox-session" style="display:block;">
                    <h2>Reporte General</h2>
                    <div id="consolesList" style="display:flex;flex-wrap:wrap;gap:24px;"></div>
                </div>
                <div id="mainbox-session-descargar" class="mainbox-session" style="display:none;">
                    <h2>Descargar Reporte</h2>
                    <div style="color:#fff;opacity:0.7;">Aquí podrás descargar el reporte generado.</div>
                </div>
                <div id="mainbox-session-consolas" class="mainbox-session" style="display:none;">
                    <h2>Añadir Consolas</h2>
                    <div style="display:flex;flex-wrap:wrap;gap:32px;align-items:flex-start;">
                        <form id="addConsoleForm" style="margin-top:24px;max-width:340px;min-width:220px;flex:1;">
                            <div class="input-group">
                                <label for="consoleType">Consola</label>
                                <select id="consoleType" name="consoleType" required class="neon-select">
                                    <option value="">Selecciona una consola</option>
                                    <option value="ps5">Play Station 5</option>
                                    <option value="switch">Nintendo Switch</option>
                                </select>
                            </div>
                            <div class="input-group">
                                <label for="consoleNumber">Número de consola</label>
                                <input type="number" id="consoleNumber" name="consoleNumber" min="1" required placeholder="Ej: 1" class="neon-input">
                            </div>
                            <button type="submit" class="neon-btn">Añadir consola</button>
                            <p id="addConsoleMsg" class="error-message" style="margin-top:10px;"></p>
                        </form>
                        <div id="miniConsolesList" style="flex:2;display:flex;flex-wrap:wrap;gap:12px;align-items:flex-start;min-width:180px;"></div>
                    </div>
                </div>
                <div id="mainbox-session-precios" class="mainbox-session" style="display:none;">
                    <h2>Añadir Precios</h2>
                    <div style="color:#fff;opacity:0.7;">Aquí podrás añadir o modificar precios.</div>
                </div>
            </div>
        </div>
    </div>
    <script>
        // Mostrar consolas en tarjetas en Reporte General (sin editar/eliminar)
        async function renderConsolesList() {
            const list = document.getElementById('consolesList');
            if (!list) return;
            list.innerHTML = '<div style="color:#fff;opacity:0.7;">Cargando consolas...</div>';
            try {
                const res = await fetch('https://zonagamer-backend.onrender.com/consoles');
                const consolas = await res.json();
                if (!Array.isArray(consolas) || consolas.length === 0) {
                    list.innerHTML = '<div style="color:#fff;opacity:0.7;">No hay consolas registradas.</div>';
                    return;
                }
                // Ordenar por número
                consolas.sort((a, b) => a.number - b.number);
                list.innerHTML = consolas.map((c) => {
                    let nombre = c.type === 'ps5' ? 'Play Station 5' : (c.type === 'switch' ? 'Nintendo Switch' : c.type);
                    let img = c.type === 'ps5' ? 'PS5.png' : (c.type === 'switch' ? 'Switch.png' : '');
                    return `<div class="console-card-admin" style="background:rgba(44,18,80,0.95);border:2px solid #81fde9;border-radius:16px;padding:18px 18px 12px 18px;min-width:210px;max-width:220px;display:flex;flex-direction:column;align-items:center;box-shadow:0 0 8px #3ef2e6;position:relative;">
                        ${img ? `<img src='${img}' alt='${nombre}' style='width:80px;height:auto;margin-bottom:10px;'>` : ''}
                        <div style='font-weight:700;font-size:18px;color:#81fde9;margin-bottom:4px;'>${nombre} <span style="color:#fff;font-size:15px;">#${c.number}</span></div>
                    </div>`;
                }).join('');
            } catch (err) {
                list.innerHTML = '<div style="color:#fff;opacity:0.7;">Error al cargar consolas.</div>';
            }
        }

        // Mostrar minitarjetas de consolas en sección Añadir Consolas
        async function renderMiniConsolesList() {
            const miniList = document.getElementById('miniConsolesList');
            if (!miniList) return;
            miniList.innerHTML = '<div style="color:#fff;opacity:0.7;">Cargando consolas...</div>';
            try {
                const res = await fetch('https://zonagamer-backend.onrender.com/consoles');
                const consolas = await res.json();
                if (!Array.isArray(consolas) || consolas.length === 0) {
                    miniList.innerHTML = '<div style="color:#fff;opacity:0.7;">No hay consolas registradas.</div>';
                    return;
                }
                // Filtrar solo consolas con _id válido (24 caracteres hex)
                const consolasValidas = consolas.filter(c => typeof c._id === 'string' && /^[a-fA-F0-9]{24}$/.test(c._id));
                consolasValidas.sort((a, b) => a.number - b.number);
                if (consolasValidas.length === 0) {
                    miniList.innerHTML = '<div style="color:#ff4d4d;opacity:0.85;">No hay consolas válidas para editar/eliminar.<br>Revisa los datos en la base.</div>';
                    return;
                }
                miniList.innerHTML = consolasValidas.map((c) => {
                    let nombre = c.type === 'ps5' ? 'PS5' : (c.type === 'switch' ? 'Switch' : c.type);
                    return `<div style="background:rgba(44,18,80,0.96);border:2px solid #81fde9;border-radius:12px;padding:14px 20px 12px 20px;min-width:120px;max-width:160px;display:flex;flex-direction:column;align-items:center;gap:6px;margin-bottom:10px;">
                        <div style='font-weight:700;font-size:18px;color:#fff;'>${nombre}</div>
                        <div style="color:#fff;font-size:15px;">#${c.number}</div>
                        <div style="display:flex;gap:10px;margin-top:8px;">
                            <button class="mini-edit-btn" data-id="${c._id}" style="padding:4px 14px;font-size:15px;border-radius:7px;border:1.5px solid #81fde9;background:#2a114d;color:#81fde9;cursor:pointer;">Editar</button>
                            <button class="mini-del-btn" data-id="${c._id}" style="padding:4px 14px;font-size:15px;border-radius:7px;border:1.5px solid #ff4d4d;background:#2a114d;color:#ff4d4d;cursor:pointer;">Eliminar</button>
                        </div>
                    </div>`;
                }).join('');
                // Botones editar/eliminar
                document.querySelectorAll('.mini-edit-btn').forEach(btn => {
                    btn.onclick = function() {
                        const id = this.dataset.id;
                        const consola = consolasValidas.find(c => c._id === id);
                        if (consola) showEditConsoleModal(consola);
                    };
                });
                document.querySelectorAll('.mini-del-btn').forEach(btn => {
                    btn.onclick = async function() {
                        const id = this.dataset.id;
                        if (confirm('¿Seguro que deseas eliminar esta consola?')) {
                            const delRes = await fetch('https://zonagamer-backend.onrender.com/consoles/' + id, { method: 'DELETE' });
                            if (delRes.ok) {
                                renderMiniConsolesList();
                            } else {
                                alert('Error al eliminar consola.');
                            }
                        }
                    };
                });
            } catch (err) {
                miniList.innerHTML = '<div style="color:#fff;opacity:0.7;">Error al cargar consolas.</div>';
            }
        }

        // Modal de edición de consola
                function showEditConsoleModal(consola) {
                        // Obtener username admin
                        const username = document.getElementById('adminUsername')?.value || 'Admin';
                        let modal = document.createElement('div');
                        modal.id = 'editConsoleModal';
                        modal.innerHTML = `
                                <div style="position:fixed;top:0;left:0;width:100vw;height:100vh;background:rgba(20,10,40,0.75);z-index:9999;display:flex;align-items:center;justify-content:center;">
                                    <div style="background:linear-gradient(135deg,#2a114d 0%,#3b1d69 100%);border:2.5px solid #81fde9;border-radius:22px;box-shadow:0 0 32px #3ef2e6,0 0 64px #81fde9;padding:36px 32px 28px 32px;min-width:320px;max-width:95vw;display:flex;flex-direction:column;align-items:center;">
                                        <div style=\"font-size:20px;font-weight:700;color:#fff;margin-bottom:18px;text-align:center;\">${username}, ¿cómo deseas editar esta consola?</div>
                                        <form id=\"editConsoleForm\" style=\"width:100%;max-width:320px;display:flex;flex-direction:column;gap:18px;background:none;box-shadow:none;padding:0;\">
                                            <div class=\"input-group\" style=\"margin-bottom:10px;\">
                                                <label for=\"editConsoleType\" style=\"color:#fff;font-weight:500;\">Tipo de consola</label>
                                                <select id=\"editConsoleType\" required style=\"width:100%;padding:10px;border-radius:8px;font-size:16px;background:#2a114d;color:#fff;border:1.5px solid #bbb;box-shadow:none;outline:none;\">
                                                    <option value=\"ps5\" ${consola.type==='ps5'?'selected':''}>Play Station 5</option>
                                                    <option value=\"switch\" ${consola.type==='switch'?'selected':''}>Nintendo Switch</option>
                                                </select>
                                            </div>
                                            <div class=\"input-group\" style=\"margin-bottom:10px;\">
                                                <label for=\"editConsoleNumber\" style=\"color:#fff;font-weight:500;\">Número de consola</label>
                                                <input type=\"number\" id=\"editConsoleNumber\" min=\"1\" required value=\"${consola.number}\" style=\"width:100%;padding:10px;border-radius:8px;font-size:16px;background:#2a114d;color:#fff;border:1.5px solid #bbb;box-shadow:none;outline:none;\">
                                            </div>
                                            <div style=\"display:flex;gap:16px;justify-content:center;\">
                                                <button type=\"submit\" style=\"min-width:110px;padding:10px 0;background:#3b1d69;color:#fff;border:1.5px solid #81fde9;border-radius:8px;font-size:16px;font-weight:600;box-shadow:none;cursor:pointer;transition:background 0.2s;\">Confirmar</button>
                                                <button type=\"button\" id=\"cancelEditConsole\" style=\"min-width:110px;padding:10px 0;background:#444;color:#fff;border:1.5px solid #bbb;border-radius:8px;font-size:16px;font-weight:600;box-shadow:none;cursor:pointer;transition:background 0.2s;\">Cancelar</button>
                                            </div>
                                        </form>
                                    </div>
                                </div>
                        `;
                        document.body.appendChild(modal);
                        document.getElementById('cancelEditConsole').onclick = () => {
                                modal.remove();
                        };
                        document.getElementById('editConsoleForm').onsubmit = async function(e) {
                                e.preventDefault();
                                const type = document.getElementById('editConsoleType').value;
                                const number = parseInt(document.getElementById('editConsoleNumber').value, 10);
                                // Validar número
                                if (!type || !number || number < 1) {
                                        alert('Completa todos los campos correctamente.');
                                        return;
                                }
                                // PUT al backend
                                const res = await fetch('https://zonagamer-backend.onrender.com/consoles/' + consola._id, {
                                        method: 'PUT',
                                        headers: { 'Content-Type': 'application/json' },
                                        body: JSON.stringify({ type, number })
                                });
                                if (res.ok) {
                                        modal.remove();
                                        renderConsolesList();
                                } else {
                                        alert('Error al editar consola.');
                                }
                        };
                }
        // Renderizar al mostrar la sección reporte
        document.getElementById('btn-reporte').addEventListener('click', renderConsolesList);
        // Renderizar minitarjetas al mostrar sección consolas
        document.getElementById('btn-consolas').addEventListener('click', renderMiniConsolesList);
        // Renderizar al cargar la página si está activa
        document.addEventListener('DOMContentLoaded', function() {
            if (document.getElementById('mainbox-session-reporte').style.display !== 'none') {
                renderConsolesList();
            }
            if (document.getElementById('mainbox-session-consolas').style.display !== 'none') {
                renderMiniConsolesList();
            }
        });
        // Añadir consola: enviar al backend
        document.addEventListener('DOMContentLoaded', function() {
            const addConsoleForm = document.getElementById('addConsoleForm');
            if (addConsoleForm) {
                addConsoleForm.addEventListener('submit', async function(e) {
                    e.preventDefault();
                    const msg = document.getElementById('addConsoleMsg');
                    msg.textContent = '';
                    const type = document.getElementById('consoleType').value;
                    const number = parseInt(document.getElementById('consoleNumber').value, 10);
                    if (!type || !number || number < 1) {
                        msg.textContent = 'Completa todos los campos correctamente.';
                        return;
                    }
                    // Validar que el número no esté repetido
                    try {
                        const resConsolas = await fetch('https://zonagamer-backend.onrender.com/consoles');
                        const consolas = await resConsolas.json();
                        if (Array.isArray(consolas) && consolas.some(c => c.number === number)) {
                            msg.textContent = 'Ya existe una consola con ese número.';
                            return;
                        }
                    } catch (err) {
                        msg.textContent = 'Error validando número de consola.';
                        return;
                    }
                    // Enviar al backend
                    try {
                        const res = await fetch('https://zonagamer-backend.onrender.com/consoles', {
                            method: 'POST',
                            headers: { 'Content-Type': 'application/json' },
                            body: JSON.stringify({ type, number })
                        });
                        if (res.ok) {
                            msg.style.color = '#81fde9';
                            msg.textContent = 'Consola añadida correctamente.';
                            addConsoleForm.reset();
                            renderMiniConsolesList();
                        } else {
                            const data = await res.json();
                            msg.textContent = data.message || 'Error al añadir consola.';
                        }
                    } catch (err) {
                        msg.textContent = 'Error de conexión con el servidor.';
                    }
                });
            }
        });
        // Cambia la sección visible en la mainbox y resalta el botón activo
        function showSession(session) {
            const sessions = ['reporte', 'descargar', 'consolas', 'precios'];
            sessions.forEach(s => {
                document.getElementById('mainbox-session-' + s).style.display = (s === session) ? 'block' : 'none';
                document.getElementById('btn-' + s).classList.toggle('active', s === session);
            });
        }
        // Login de admin conectado a backend (más robusto)
        document.addEventListener('DOMContentLoaded', function() {
            try {
                document.getElementById('adminPanelSesiones').style.display = 'none';
                const loginForm = document.getElementById('adminLoginForm');
                if (loginForm) {
                    loginForm.addEventListener('submit', async function(event) {
                        event.preventDefault();
                        const errorMsg = document.getElementById('adminErrorMessage');
                        errorMsg.textContent = '';
                        const username = document.getElementById('adminUsername').value;
                        const password = document.getElementById('adminPassword').value;
                        if (!username || !password) {
                            errorMsg.textContent = 'Completa todos los campos.';
                            return;
                        }
                        try {
                            const res = await fetch('https://zonagamer-backend.onrender.com/admins');
                            if (!res.ok) {
                                errorMsg.textContent = 'No se pudo conectar al backend.';
                                return;
                            }
                            const admins = await res.json();
                            if (!Array.isArray(admins)) {
                                errorMsg.textContent = 'Respuesta inesperada del servidor.';
                                return;
                            }
                            const admin = admins.find(a => a.username === username && a.password === password);
                            if (admin) {
                                document.getElementById('adminLoginContainer').style.display = 'none';
                                document.getElementById('adminPanelSesiones').style.display = 'block';
                            } else {
                                errorMsg.textContent = 'Usuario o contraseña incorrectos.';
                            }
                        } catch (err) {
                            errorMsg.textContent = 'Error de conexión con el servidor.';
                        }
                    });
                }
            } catch (e) {
                const errorMsg = document.getElementById('adminErrorMessage');
                if (errorMsg) errorMsg.textContent = 'Error inesperado en el login.';
            }
        });
    </script>
</body>
</html>
